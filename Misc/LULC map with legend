/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var s2 = ee.ImageCollection("COPERNICUS/S2"),
    l8 = ee.ImageCollection("LANDSAT/LC8_L1T_TOA_FMASK"),
    rice = /* color: #d63000 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[121.64633274078369, 17.057194886415406],
                  [121.65156841278076, 17.05762567574177],
                  [121.65223360061646, 17.061133494688814],
                  [121.64704084396362, 17.060579632920668]]]),
            {
              "class": 1,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.65066719055176, 17.024923890872408],
                  [121.65047407150269, 17.02151798095412],
                  [121.65442228317261, 17.021538498669333],
                  [121.65521621704102, 17.02547785831095]]]),
            {
              "class": 1,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.5753722190857, 16.96315650808366],
                  [121.5766167640686, 16.962315017941187],
                  [121.57841920852661, 16.96106303782614],
                  [121.58397674560547, 16.964203234463206],
                  [121.58163785934448, 16.968061704848225],
                  [121.57477140426636, 16.964264806421525]]]),
            {
              "class": 1,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.66886329650879, 16.895886992653644],
                  [121.67002201080322, 16.88837233599347],
                  [121.67912006378174, 16.8918627875123],
                  [121.67860507965088, 16.899541553550296]]]),
            {
              "class": 1,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.72579050064087, 16.91161341981419],
                  [121.72574758529663, 16.905782887048193],
                  [121.7333436012268, 16.906439857502715],
                  [121.73319339752197, 16.912516725654367]]]),
            {
              "class": 1,
              "system:index": "4"
            })]),
    rice3 = /* color: #98ff00 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[121.55058860778809, 16.840279667406275],
                  [121.54539585113525, 16.83420047490315],
                  [121.5503740310669, 16.8336664824525],
                  [121.55719757080078, 16.834159398614254],
                  [121.56118869781494, 16.83559706342398],
                  [121.56037330627441, 16.841676211082508],
                  [121.55930042266846, 16.840485042122534],
                  [121.55651092529297, 16.83999214242921],
                  [121.55290603637695, 16.840526117039033]]]),
            {
              "class": 2,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.59616470336914, 16.87625791526139],
                  [121.59719467163086, 16.87625791526139],
                  [121.60208702087402, 16.878680861592574],
                  [121.60629272460938, 16.881473371342626],
                  [121.60324573516846, 16.886278034093394],
                  [121.60062789916992, 16.8837730542421],
                  [121.59453392028809, 16.880159254251872]]]),
            {
              "class": 2,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.5986967086792, 16.91621202263439],
                  [121.59848213195801, 16.914939206301646],
                  [121.60041332244873, 16.91522661719293],
                  [121.60200119018555, 16.914364383203758],
                  [121.60436153411865, 16.915678261993396],
                  [121.60607814788818, 16.916417314785942],
                  [121.60414695739746, 16.919907247132425],
                  [121.60315990447998, 16.919578785668023],
                  [121.6032886505127, 16.91916820803205]]]),
            {
              "class": 2,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.64618253707886, 16.92000989122258],
                  [121.6497015953064, 16.922268047052963],
                  [121.64777040481567, 16.925039383109507],
                  [121.6444444656372, 16.92282231752717]]]),
            {
              "class": 2,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.66264057159424, 16.93702750764056],
                  [121.663498878479, 16.93538534393881],
                  [121.66624546051025, 16.934441093320636],
                  [121.66787624359131, 16.93522112678037],
                  [121.6706657409668, 16.937273830959636],
                  [121.67319774627686, 16.936822237961653],
                  [121.67096614837646, 16.94055811106279],
                  [121.66912078857422, 16.941132854185618],
                  [121.66637420654297, 16.94055811106279],
                  [121.6646146774292, 16.94215917682262]]]),
            {
              "class": 2,
              "system:index": "4"
            })]),
    corn = /* color: #0b4a8b */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[121.66588068008423, 16.99790060008607],
                  [121.6656231880188, 16.995725435266543],
                  [121.6675329208374, 16.995520229735362],
                  [121.66772603988647, 16.997633835947354]]]),
            {
              "class": 3,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.72340869903564, 17.018317189837166],
                  [121.72295808792114, 17.01727076548495],
                  [121.72295808792114, 17.016470554680605],
                  [121.72555446624756, 17.01640899986168],
                  [121.7263913154602, 17.01794786426314],
                  [121.72512531280518, 17.019958628016663],
                  [121.72411680221558, 17.019897074344712],
                  [121.72405242919922, 17.01924050058429]]]),
            {
              "class": 3,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.74832105636597, 17.020717788306428],
                  [121.74759149551392, 17.019158428702298],
                  [121.74920082092285, 17.018112009052672],
                  [121.74954414367676, 17.018378744028666],
                  [121.74973726272583, 17.020348467468995]]]),
            {
              "class": 3,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.68545007705688, 16.987742774535715],
                  [121.68336868286133, 16.98618314047021],
                  [121.68379783630371, 16.984972362977626],
                  [121.68429136276245, 16.98429514503978],
                  [121.68487071990967, 16.98406940518386],
                  [121.68517112731934, 16.984151492435625],
                  [121.68688774108887, 16.98172990340935],
                  [121.68830394744873, 16.98275600427064],
                  [121.688711643219, 16.98298174570699]]]),
            {
              "class": 3,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.6462254524231, 16.95833328176259],
                  [121.64648294448853, 16.958476954123128],
                  [121.64684772491455, 16.95938003501664],
                  [121.647469997406, 16.960201013880354],
                  [121.644766330719, 16.963690134025608],
                  [121.64345741271973, 16.962540783959177]]]),
            {
              "class": 3,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.5726363658905, 16.992329254821968],
                  [121.57203555107117, 16.991405811434824],
                  [121.5721321105957, 16.991087735437315],
                  [121.57271146774292, 16.99068757454505],
                  [121.57281875610352, 16.990882524830006],
                  [121.57261490821838, 16.991015911750317],
                  [121.57271146774292, 16.991241643245424],
                  [121.57291531562805, 16.991241643245424],
                  [121.573086977005, 16.991723886892753],
                  [121.57289385795593, 16.991898315140602]]]),
            {
              "class": 3,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.57311916351318, 16.993324516491253],
                  [121.5727436542511, 16.992678110029065],
                  [121.57287240028381, 16.99266784959106],
                  [121.5733015537262, 16.992862797817097],
                  [121.5733015537262, 16.992955141642902],
                  [121.5733015537262, 16.99321165203147]]]),
            {
              "class": 3,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.79709434509277, 16.966091432003118],
                  [121.79443359375, 16.96494209663086],
                  [121.79670810699463, 16.961576145439743],
                  [121.79979801177979, 16.96256130812919]]]),
            {
              "class": 3,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.9868016242981, 17.034946344406492],
                  [121.98695182800293, 17.033694849357712],
                  [121.9873595237732, 17.033530718238275],
                  [121.98734879493713, 17.034895053790393]]]),
            {
              "class": 3,
              "system:index": "8"
            })]),
    water = /* color: #ffc82d */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[121.8277359008789, 17.237464859471796],
                  [121.83279991149902, 17.236399173781024],
                  [121.8354606628418, 17.244842514798417],
                  [121.83134078979492, 17.246072095354503]]]),
            {
              "class": 7,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.8999195098877, 17.132301296615047],
                  [121.90155029296875, 17.133080505229707],
                  [121.8999195098877, 17.135869225082146],
                  [121.89850330352783, 17.135008007240913]]]),
            {
              "class": 7,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.85069561004639, 17.103550317357474],
                  [121.85232639312744, 17.10322217783435],
                  [121.85494422912598, 17.112122757476538],
                  [121.85361385345459, 17.11232783494061]]]),
            {
              "class": 7,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.82451725006104, 16.88385518525611],
                  [121.82589054107666, 16.883978381710133],
                  [121.82524681091309, 16.89194491500586],
                  [121.82348728179932, 16.89165746862203]]]),
            {
              "class": 7,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.99233770370483, 16.993016704168156],
                  [121.99542760848999, 16.989959074317987],
                  [121.99662923812866, 16.990328455068507],
                  [121.99332475662231, 16.993509203642525],
                  [121.99233770370483, 16.993180870803357]]]),
            {
              "class": 7,
              "system:index": "4"
            })]),
    builtups = /* color: #00ffff */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[121.8348491191864, 17.048701979664834],
                  [121.83395862579346, 17.04909175920142],
                  [121.83451652526855, 17.049163560606317],
                  [121.83478474617004, 17.049317420666732],
                  [121.83487057685852, 17.049594368456173],
                  [121.83454871177673, 17.050609840171695],
                  [121.83438777923584, 17.051020130208293],
                  [121.83385133743286, 17.051102188107485],
                  [121.83390498161316, 17.051963793872716],
                  [121.83205962181091, 17.052127908806003],
                  [121.83175921440125, 17.05180993599181],
                  [121.83168411254883, 17.05063035469493],
                  [121.83023571968079, 17.051502219849844],
                  [121.82937741279602, 17.050773956294474],
                  [121.82852983474731, 17.051245789344318],
                  [121.82831525802612, 17.050589325646214],
                  [121.8285083770752, 17.049871315835066],
                  [121.83325052261353, 17.04767624015669],
                  [121.83359384536743, 17.047101823572493],
                  [121.83380842208862, 17.04599401517353],
                  [121.83361530303955, 17.045747834637428],
                  [121.83428049087524, 17.045378563225196],
                  [121.83485984802246, 17.04572731957811],
                  [121.83704853057861, 17.04833271409061],
                  [121.83758497238159, 17.047881388508802],
                  [121.83818578720093, 17.048250654975007],
                  [121.83837890625, 17.048660950192634],
                  [121.83977365493774, 17.04886609746356],
                  [121.83891534805298, 17.049625140407432],
                  [121.83794975280762, 17.049686684294763],
                  [121.83801412582397, 17.05005594719293],
                  [121.83775663375854, 17.050732927277284]]]),
            {
              "class": 8,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.76130294799805, 16.94515600686993],
                  [121.7603588104248, 16.94310338870249],
                  [121.75851345062256, 16.943637071581215],
                  [121.75821304321289, 16.942446546157424],
                  [121.75950050354004, 16.941994965577027],
                  [121.7585563659668, 16.938505442717506],
                  [121.75748348236084, 16.937520153956218],
                  [121.75705432891846, 16.9377664766303],
                  [121.7570972442627, 16.938464389122135],
                  [121.75671100616455, 16.938546496303896],
                  [121.75752639770508, 16.94306233611062],
                  [121.75696849822998, 16.94326759898032],
                  [121.75589561462402, 16.938464389122135],
                  [121.75409317016602, 16.93887492467263],
                  [121.75323486328125, 16.9378896378464],
                  [121.75267696380615, 16.935056909478615],
                  [121.75550937652588, 16.934810583257256],
                  [121.75714015960693, 16.934071602658502],
                  [121.75851345062256, 16.933825275147356],
                  [121.75859928131104, 16.933004181114867],
                  [121.75825595855713, 16.931567257937733],
                  [121.75696849822998, 16.931444092583494],
                  [121.7565393447876, 16.930048212935976],
                  [121.7640495300293, 16.929021824237985],
                  [121.7664098739624, 16.92869337867263],
                  [121.76761150360107, 16.927584870658784],
                  [121.76894187927246, 16.925039383109507],
                  [121.77061557769775, 16.925408891501935],
                  [121.7704439163208, 16.926763749403214],
                  [121.77258968353271, 16.929883991120402],
                  [121.77284717559814, 16.930869319864723],
                  [121.77340507507324, 16.9304587668481],
                  [121.77383422851562, 16.930951430360587],
                  [121.77319049835205, 16.931690423211368],
                  [121.77379131317139, 16.932634687631456],
                  [121.7755937576294, 16.932511522975776],
                  [121.77516460418701, 16.93419476629316],
                  [121.77602291107178, 16.934482147793876],
                  [121.77670955657959, 16.93238835823948],
                  [121.77816867828369, 16.93238835823948],
                  [121.77778244018555, 16.93308629067933],
                  [121.7785120010376, 16.934235820820142],
                  [121.77688121795654, 16.934441093320636],
                  [121.7768383026123, 16.935344289662645],
                  [121.77580833435059, 16.935754832021292],
                  [121.77696704864502, 16.93608326526328],
                  [121.77477836608887, 16.937930691567185],
                  [121.77602291107178, 16.93887492467263],
                  [121.77507877349854, 16.94035284523619],
                  [121.7741346359253, 16.940311792044],
                  [121.77340507507324, 16.93965493975032],
                  [121.77173137664795, 16.941009695092855],
                  [121.7701005935669, 16.942036018401875],
                  [121.76658153533936, 16.942364440678]]]),
            {
              "class": 8,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.52917385101318, 16.787408811994442],
                  [121.52960300445557, 16.785888608346806],
                  [121.53011798858643, 16.78494361075768],
                  [121.52998924255371, 16.783793172564653],
                  [121.52745723724365, 16.784121869902183],
                  [121.52758598327637, 16.783300125491984],
                  [121.53059005737305, 16.783259038178166],
                  [121.53282165527344, 16.779273526503996],
                  [121.53337955474854, 16.77787652324395],
                  [121.53350830078125, 16.77664386478013],
                  [121.53466701507568, 16.776808219703913],
                  [121.5368127822876, 16.77656168726493],
                  [121.53758525848389, 16.777547815102025],
                  [121.53835773468018, 16.777054751823094],
                  [121.53921604156494, 16.77787652324395],
                  [121.53788566589355, 16.778903732522874],
                  [121.53698444366455, 16.7810403100363],
                  [121.53784275054932, 16.781163573390607],
                  [121.54106140136719, 16.78083487093475],
                  [121.54161930084229, 16.782807077139676],
                  [121.54179096221924, 16.783669910916462],
                  [121.54020309448242, 16.784204044147696],
                  [121.53955936431885, 16.785477740407458],
                  [121.53810024261475, 16.785601000882586],
                  [121.5377140045166, 16.787121206832186],
                  [121.53728485107422, 16.790161582226805],
                  [121.53076171875, 16.789586379804454]]]),
            {
              "class": 8,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.69032096862793, 16.779232438319408],
                  [121.68886184692383, 16.77947896729367],
                  [121.68830394744873, 16.77767108072188],
                  [121.68937683105469, 16.777547815102025],
                  [121.69220924377441, 16.777383460817852],
                  [121.69341087341309, 16.777219106391534],
                  [121.69345378875732, 16.776068621427598],
                  [121.69525623321533, 16.77557555431111],
                  [121.69559955596924, 16.77380871997344],
                  [121.69748783111572, 16.77241167654505],
                  [121.69924736022949, 16.772699303972555],
                  [121.6995906829834, 16.773849809330613],
                  [121.70130729675293, 16.772658214366704],
                  [121.70156478881836, 16.77376763060739],
                  [121.70177936553955, 16.77549337633401],
                  [121.70062065124512, 16.775945354768403],
                  [121.70074939727783, 16.778821555984898],
                  [121.70109272003174, 16.77984876015535],
                  [121.70173645019531, 16.78182097659628],
                  [121.7016077041626, 16.78264272740455],
                  [121.70092105865479, 16.783793172564653],
                  [121.69971942901611, 16.78449165372706],
                  [121.69856071472168, 16.783752085357474],
                  [121.69199466705322, 16.782149677346112]]]),
            {
              "class": 8,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.57938480377197, 16.88093951237759],
                  [121.58045768737793, 16.880569916825245],
                  [121.58015727996826, 16.87970752438958],
                  [121.58268928527832, 16.87872192821163],
                  [121.5818738937378, 16.876873921512903],
                  [121.5825605392456, 16.87654538509546],
                  [121.58843994140625, 16.880775247776967],
                  [121.58985614776611, 16.87921472694365],
                  [121.59037113189697, 16.879666457984882],
                  [121.58904075622559, 16.881062710734277],
                  [121.59122943878174, 16.88410157808375],
                  [121.59071445465088, 16.884635428107025],
                  [121.58818244934082, 16.884717558745834],
                  [121.58702373504639, 16.88586738393692],
                  [121.5853500366211, 16.885456732887025],
                  [121.58449172973633, 16.88586738393692],
                  [121.5836763381958, 16.883731988721692],
                  [121.58217430114746, 16.884512232081818],
                  [121.58135890960693, 16.882582150523454],
                  [121.57994270324707, 16.88319813614347]]]),
            {
              "class": 8,
              "system:index": "4"
            })]),
    forest = /* color: #bf04c2 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[121.93777084350586, 17.44843091736737],
                  [121.9369125366211, 17.433364121104333],
                  [121.95802688598633, 17.432872791576962],
                  [121.96249008178711, 17.44892220498196],
                  [121.9398307800293, 17.44843091736737]]]),
            {
              "class": 6,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[122.09381103515625, 17.188682949712515],
                  [122.09999084472656, 17.130947926520484],
                  [122.16110229492188, 17.14013424508324],
                  [122.16110229492188, 17.196554514688234]]]),
            {
              "class": 6,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[122.22633361816406, 16.908369694971217],
                  [122.18788146972656, 16.84069041661595],
                  [122.27508544921875, 16.819658912061236],
                  [122.29156494140625, 16.908369694971217]]]),
            {
              "class": 6,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.65993690490723, 17.34400231588605],
                  [121.66234016418457, 17.344739667759796],
                  [121.6611385345459, 17.34826253024887],
                  [121.65804862976074, 17.347279412639434]]]),
            {
              "class": 6,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[122.18564987182617, 17.35350573516074],
                  [122.1928596496582, 17.35473458962524],
                  [122.19620704650879, 17.357519962583844],
                  [122.19483375549316, 17.361452181765817],
                  [122.18599319458008, 17.361370261393365]]]),
            {
              "class": 6,
              "system:index": "4"
            })]),
    sugarcane = /* color: #ff0000 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[121.85756206512451, 16.970073003721005],
                  [121.8574333190918, 16.969108403888928],
                  [121.85847401618958, 16.96896473966018],
                  [121.85869932174683, 16.96998064863246]]]),
            {
              "class": 5,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.85639262199402, 16.974051925643344],
                  [121.85647040605545, 16.97404422955082],
                  [121.85654550790787, 16.974082710010308],
                  [121.85649991035461, 16.97413401727733],
                  [121.85639530420303, 16.974069883191355]]]),
            {
              "class": 5,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.87298476696014, 17.018440298199927],
                  [121.87295258045197, 17.018127397619317],
                  [121.87371969223022, 17.018112009052672],
                  [121.87378406524658, 17.01846594576531]]]),
            {
              "class": 5,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.89216256141663, 17.0166090529492],
                  [121.89252197742462, 17.01657314600052],
                  [121.89263999462128, 17.016957862949482],
                  [121.89230740070343, 17.017050194899582]]]),
            {
              "class": 5,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.91793322563171, 17.00919925170556],
                  [121.91770792007446, 17.008940198313606],
                  [121.91804051399231, 17.008688839234377],
                  [121.91827923059464, 17.008865816580407],
                  [121.91794663667679, 17.009181297521632]]]),
            {
              "class": 5,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.95228695869446, 17.169140958892985],
                  [121.95345103740692, 17.16937160022384],
                  [121.95335984230042, 17.169858508758065],
                  [121.9522225856781, 17.169668870849367]]]),
            {
              "class": 5,
              "system:index": "5"
            })]),
    cassava = /* color: #00ff00 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[121.85500860214233, 16.969631751221286],
                  [121.8549656867981, 16.968985263128147],
                  [121.85680031776428, 16.968492699277483],
                  [121.85707926750183, 16.969385470305415],
                  [121.85606002807617, 16.969549657618558]]]),
            {
              "class": 4,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[122.00223505496979, 17.106272827659964],
                  [122.00237452983856, 17.10594982004453],
                  [122.00287342071533, 17.10617541272386],
                  [122.00280904769897, 17.106467657379284]]]),
            {
              "class": 4,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.88790321350098, 17.1343928491965],
                  [121.88880443572998, 17.133357328556382],
                  [121.8896734714508, 17.134239059367225],
                  [121.88923358917236, 17.13496699676797],
                  [121.88862204551697, 17.13467992320395],
                  [121.88820362091064, 17.13506952293335],
                  [121.88802123069763, 17.134987502005576],
                  [121.88822507858276, 17.134659417932422]]]),
            {
              "class": 4,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.85442924499512, 16.963679872002555],
                  [121.85594201087952, 16.964039042475676],
                  [121.8558132648468, 16.964582927884617],
                  [121.8558669090271, 16.96506524004289],
                  [121.85418248176575, 16.96463423774756]]]),
            {
              "class": 4,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.8555235862732, 16.96045756903954],
                  [121.85713291168213, 16.960919367443182],
                  [121.85686469078064, 16.961832698720986],
                  [121.85522317886353, 16.96136064041272]]]),
            {
              "class": 4,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.9835615158081, 17.03418211276988],
                  [121.98377072811127, 17.033623042010685],
                  [121.98426425457001, 17.033720494832096],
                  [121.98401212692261, 17.034361630549064]]]),
            {
              "class": 4,
              "system:index": "5"
            })]),
    others = /* color: #0000ff */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[121.6870379447937, 16.634372354437268],
                  [121.68825030326843, 16.63486578636989],
                  [121.68775677680969, 16.635667610552535],
                  [121.68660879135132, 16.634958304715926]]]),
            {
              "class": 9,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.90813779830933, 17.011607661634308],
                  [121.90845966339111, 17.011505067593728],
                  [121.90914630889893, 17.011299879343966],
                  [121.90946817398071, 17.011628180435675],
                  [121.9098973274231, 17.01314656549815],
                  [121.90770864486694, 17.01292086038952]]]),
            {
              "class": 9,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.82316541671753, 16.93522112678037],
                  [121.82353019714355, 16.931300399568368],
                  [121.8284010887146, 16.930951430360587],
                  [121.82734966278076, 16.936432224954746]]]),
            {
              "class": 9,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.82432413101196, 16.925100967891925],
                  [121.82458162307739, 16.921898532497167],
                  [121.82664155960083, 16.92146743126571],
                  [121.82651281356812, 16.925018854844218]]]),
            {
              "class": 9,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.82451725006104, 16.95673235374168],
                  [121.82337999343872, 16.955500861367494],
                  [121.82479619979858, 16.95472091202314],
                  [121.82522535324097, 16.955151937060936]]]),
            {
              "class": 9,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[121.69564247131348, 17.1790890275972],
                  [121.69856071472168, 17.177612995490623],
                  [121.70199394226074, 17.17228278169308],
                  [121.70345306396484, 17.171380730350172],
                  [121.70722961425781, 17.169084579857373],
                  [121.7091178894043, 17.165640300811784],
                  [121.71289443969727, 17.16359010434713],
                  [121.71735763549805, 17.1677724810965],
                  [121.71504020690918, 17.17047867461885],
                  [121.70722961425781, 17.17375885624233],
                  [121.70448303222656, 17.17671097008333],
                  [121.70165061950684, 17.179007026121887],
                  [121.69890403747559, 17.18187705616887],
                  [121.6966724395752, 17.186059020371875],
                  [121.69538497924805, 17.18827296320316],
                  [121.69220924377441, 17.190486879572397]]]),
            {
              "class": 9,
              "system:index": "5"
            })]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/

// define start of time series
var startdate = ee.Date.fromYMD(2013,1,1);
// define end of time series
var enddate = ee.Date.fromYMD(2016,12,9);

//Isabela Province
var province = ee.FeatureCollection('ft:1t9a8O96mnbrGAI8Cb9hJpKkw-2aTvhJHWMV-o7cz');
var Isabela = province.filter(ee.Filter.eq('NAME_1', 'Isabela')).geometry();

// filter on date and location
var l8images = l8.filterDate(startdate,enddate).filterBounds(Isabela);

// set cloud threshold
var cloud_thresh = 40;
 
// the cloud function
var cloudfunction = function(image) {
  //use add the cloud likelihood band to the image
  var CloudScore = ee.Algorithms.Landsat.simpleCloudScore(image);
  //isolate the cloud likelihood band
  var quality = CloudScore.select('cloud');
  //get pixels above the threshold
  var cloud01 = quality.gt(cloud_thresh);
  //create a mask from high likelihood pixels
  var cloudmask = image.mask().and(cloud01.not());
  //mask those pixels from the images
  return image.updateMask(cloudmask);
};
 
// filter clouds for all images in imagecollection
l8images = l8images.map(cloudfunction);

var ls8_viz = {bands:["B4","B3","B2"], min:0, max:0.3};
Map.addLayer(l8images.median().clip(Isabela), ls8_viz, "ls8_nocloud");

// list with l8 bands
var LS8_bands = ['B2', 'B3', 'B4', 'B5', 'B6', 'B7'];//, 'B10', 'B11'];


// make the training image
var TrainingImage = ee.Image(1)
      .addBands(l8images.median().select(LS8_bands).float())
      .clip(Isabela);

// set the selection bands
var predictionBands = TrainingImage.bandNames();
      
// merge all into a single ImageCollection
var trainingFeatures = rice  //1
.merge(rice3)                //2
.merge(corn)                 //3
.merge(cassava)              //4
.merge(sugarcane)            //5
.merge(forest)               //6
.merge(water)                //7
.merge(builtups)             //8
.merge(others)               //9


// sample the regions
var classifierTraining = TrainingImage.select(predictionBands).sampleRegions({collection: trainingFeatures, properties: ['class'], scale: 30 });
 
// train the classifier
var classifier = ee.Classifier.cart()
.train({features:classifierTraining, classProperty:'class', inputProperties: predictionBands});
 
// get the classified image
var classified = TrainingImage.select(predictionBands).classify(classifier);

var vis = ['E0F374'  //irr rice (2 seasons)
          ,'008000' //irr rice (3 seasons)
          ,'FFFF00',//corn
          'E7C2AD', //cassava 
          'FF1919', //sugarcane
          '004C00', //forest
          '053CA2', //water
          'E5E5E5', //builtups and road
          '423504'  //others
          ];
          
// add layer to map
Map.addLayer(classified, {min: 1, max: 9,palette: vis },
'classified');


var sld_intervals = '\
<RasterSymbolizer>\
  <ColorMap  type="intervals" extended="false" >\
    <ColorMapEntry color="#E0F374" quantity="1" label="Irr Rice (2)" opacity="1"/>\
    <ColorMapEntry color="#008000" quantity="2" label="Irr Rice (3)" />\
    <ColorMapEntry color="#FFFF00" quantity="3" label="Corn" />\
    <ColorMapEntry color="#E7C2AD" quantity="4" label="Cassava" />\
    <ColorMapEntry color="#FF1919" quantity="5" label="Sugarcane" />\
    <ColorMapEntry color="#004C00" quantity="6" label="Forest" />\
    <ColorMapEntry color="#053CA2" quantity="7" label="Water" />\
    <ColorMapEntry color="#E5E5E5" quantity="8" label="Builtups" />\
     <ColorMapEntry color="#423504" quantity="9" label="Others" />\
  </ColorMap>\
</RasterSymbolizer>';

Map.addLayer(classified.sldStyle(sld_intervals), {}, 'SLD intervals');

//Add legend
var legend = ui.Panel({
  style: {
    position: 'bottom-left',
    padding: '8px 15px'
  }
});

var colors=["E0F374", "008000", "FFFF00", "E7C2AD", "FF1919", "004C00", "053CA2", "E5E5E5", "423504"];
var names= ["Irrigated Rice (2 seasons)", "Irrigated rice (3 seasons)", "Corn", "Cassava", "Sugarcane","Water", "Forest", "Buildups", "Others"];
var legend = ui.Panel({style: {position: 'bottom-left'}});
legend.add(ui.Label({
  value: "Classification",
  style: {
    fontWeight: 'bold',
    fontSize: '18px',
    margin: '0 0 4px 0',
    padding: '0px'
  }
}));

var entry;
for (var x = 0; x<9; x++){
  entry = [
    ui.Label({style:{color:colors[x],margin: '0 0 4px 0'}, value: '██'}),
    ui.Label({
      value: names[x],
      style: {
        margin: '0 0 4px 4px'
      }
    })
  ];
  legend.add(ui.Panel(entry, ui.Panel.Layout.Flow('horizontal')))
}

Map.add(legend);

//Print area
    // Compute areas satisfying condition
    //classify = classified.clip(selected).updateMask(treeCover.eq(0));
    var class1 = classified.eq(1);
    var areaHa1 = class1.multiply(ee.Image.pixelArea()).divide(10000);
    var class2 = classified.eq(2);
    var areaHa2 = class2.multiply(ee.Image.pixelArea()).divide(10000);
    var class3 = classified.eq(3);
    var areaHa3 = class3.multiply(ee.Image.pixelArea()).divide(10000);
    var class4 = classified.eq(4);
    var areaHa4 = class4.multiply(ee.Image.pixelArea()).divide(10000);
    var class5 = classified.eq(5);
    var areaHa5 = class5.multiply(ee.Image.pixelArea()).divide(10000);
    var class6 = classified.eq(6);
    var areaHa6 = class6.multiply(ee.Image.pixelArea()).divide(10000);
    var class7 = classified.eq(7);
    var areaHa7 = class7.multiply(ee.Image.pixelArea()).divide(10000);
    var class8 = classified.eq(8);
    var areaHa8 = class8.multiply(ee.Image.pixelArea()).divide(10000);
     var class9 = classified.eq(9);
    var areaHa9 = class9.multiply(ee.Image.pixelArea()).divide(10000);
    
    // Compute stat for Class 1
    var stats1 = areaHa1.reduceRegion({
        reducer: ee.Reducer.sum(), 
        geometry: Isabela,
        maxPixels: 10000000000, 
        crs: 'EPSG: 4326',
        scale: 300
        });

    // Compute stat for Class 2
    var stats2 = areaHa2.reduceRegion({
        reducer: ee.Reducer.sum(), 
        geometry: Isabela,
        maxPixels: 10000000000, 
        crs: 'EPSG: 4326',
        scale: 300
        });

    // Compute stat for Class 3
    var stats3 = areaHa3.reduceRegion({
        reducer: ee.Reducer.sum(), 
        geometry: Isabela,
        maxPixels: 10000000000, 
        crs: 'EPSG: 4326',
        scale: 300
        });

    // Compute stat for Class 4
    var stats4 = areaHa4.reduceRegion({
        reducer: ee.Reducer.sum(), 
        geometry: Isabela,
        maxPixels: 10000000000, 
        crs: 'EPSG: 4326',
        scale: 300
        });

    // Compute stat for Class 5
    var stats5 = areaHa5.reduceRegion({
        reducer: ee.Reducer.sum(), 
        geometry:Isabela,
        maxPixels: 10000000000, 
        crs: 'EPSG: 4326',
        scale: 300
        });

    // Compute stat for Class 6
    var stats6 = areaHa6.reduceRegion({
        reducer: ee.Reducer.sum(), 
        geometry: Isabela,
        maxPixels: 10000000000, 
        crs: 'EPSG: 4326',
        scale: 300
        });
    // Compute stat for Class 7
    var stats7 = areaHa7.reduceRegion({
        reducer: ee.Reducer.sum(), 
        geometry: Isabela,
        maxPixels: 10000000000, 
        crs: 'EPSG: 4326',
        scale: 300
        });
    // Compute stat for Class 8
    var stats8 = areaHa8.reduceRegion({
        reducer: ee.Reducer.sum(), 
        geometry: Isabela,
        maxPixels: 10000000000, 
        crs: 'EPSG: 4326',
        scale: 300
        });
    // Compute stat for Class 9
    var stats9 = areaHa9.reduceRegion({
        reducer: ee.Reducer.sum(), 
        geometry: Isabela,
        maxPixels: 10000000000, 
        crs: 'EPSG: 4326',
        scale: 300
        });

print( 'Area for Class 1 (2 seasons irrigated rice): ', stats1.get('classification'), 'hectare');
print( 'Area for Class 2 (3 seasons irrigated rice): ', stats2.get('classification'), 'hectare');
print( 'Area for Class 3 (Corn): ', stats3.get('classification'), 'hectare');
print( 'Area for Class 4 (Cassava): ', stats4.get('classification'), 'hectare');
print( 'Area for Class 5 (Sugarcane): ', stats5.get('classification'), 'hectare');
print( 'Area for Class 6 (Forest): ', stats6.get('classification'), 'hectare');
print( 'Area for Class 7 (Water): ', stats7.get('classification'), 'hectare');
print( 'Area for Class 8 (Builtups): ', stats8.get('classification'), 'hectare');
print( 'Area for Class 9 (Others): ', stats9.get('classification'), 'hectare');

//Map.centerObject(Isabela);